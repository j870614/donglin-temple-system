import{f as C,g as p,h as N,B as $,c as r,a as e,b as x,w as f,k,M as A,t as d,i as g,o as _,j as I,F as M,v as S,x as B,u as y,p as D,e as V,_ as P}from"./index-0a7f7a6a.js";import{_ as U}from"./BackTitle.vue_vue_type_script_setup_true_lang-cc4a5e12.js";import{_ as j}from"./StickyTable.vue_vue_type_script_setup_true_lang-99a21f87.js";import{g as F,a as K}from"./Timer-8447a705.js";import{a as v}from"./SweetAlert-183ed47c.js";import{A as z}from"./AdminStore-94bf0786.js";import"./OpenSideBar.vue_vue_type_script_setup_true_lang-b5b66885.js";const s=i=>(D("data-v-55a56e67"),i=i(),V(),i),E={class:"row"},H={class:"col h-100 gx-xl-5 pt-xl-4 pb-xl-5 py-3 mb-xl-2"},L={class:"fs-5 mb-4"},O=s(()=>e("label",{class:"form-label fw-semibold",for:"search"},"查詢權限名單",-1)),T=s(()=>e("option",{disabled:""},"選擇堂口名稱",-1)),q=s(()=>e("option",{value:"知客",selected:""},"知客",-1)),G=s(()=>e("option",{value:"寮房"},"寮房",-1)),J=[T,q,G],Q={class:"fs-3"},R=s(()=>e("tr",null,[e("th",null,"編號"),e("th",null,"性別"),e("th",null,"法名"),e("th",null,"俗名"),e("th",null,"電話"),e("th",null,"執事名稱"),e("th",null,"核發權限者"),e("th",null,"核發權限日期"),e("th",null,"修改")],-1)),W={key:0},X=s(()=>e("td",{colspan:"9"},"當前堂口無任何人員",-1)),Y=[X],Z=["onClick"],ee=s(()=>e("td",null,"性別",-1)),te=s(()=>e("td",null,"法名",-1)),se=s(()=>e("td",null,"俗名",-1)),oe=s(()=>e("td",null,"電話",-1)),ae=s(()=>e("td",null,"執事名稱",-1)),le=s(()=>e("td",null,"核發權限者",-1)),ne=["onClick","onKeydown"],ie=s(()=>e("p",{class:"mb-0 d-flex align-items-center justify-content-center gap-2"},[e("span",{class:"material-symbols-outlined"}," edit "),e("span",{class:"d-none d-xl-block"},"修改")],-1)),ce=[ie],re={class:"d-flex justify-content-end gap-3 mt-5"},de=["disabled"],_e=s(()=>e("button",{type:"button",class:"btn btn-primary py-3 flex-grow-1",style:{"max-width":"184px"}}," 查看個資 ",-1)),ue=C({__name:"AuthorityManagement",setup(i){const u=p("知客"),n=z(),m=p([]);N(()=>{n.getManagers()}),$(()=>n.managers,()=>{m.value=n.managers});function h(){console.log(1)}const l=p({Id:0,ChurchName:"",DeaconName:""});async function w(o){try{(await v.fire({html:`<p class="mb-0 fs-3">是否移除<b class="px-2 text-danger fw-semibold">${o.legalName?`${o.legalName}-`:""}${o.originalName?`${o.originalName}-`:""}${o.sex}</b>的權限</p>`,showCancelButton:!0})).isConfirmed&&(n.patchAuth(l.value,!1),h())}catch(t){console.error(t)}}async function b(o){try{const{value:t}=await v.fire({html:`<p class="mb-0 fs-3">是否修改<b class="px-2 text-danger fw-semibold">${o.legalName?`${o.legalName}-`:""}${o.originalName?`${o.originalName}-`:""}${o.sex}</b>的權限</p>`,input:"select",inputOptions:{知客:{總知客:"總知客",副總知客:"副總知客",知客志工:"知客志工"},寮房:{寮房師:"寮房師",副寮房師:"副寮房師",寮房志工:"寮房志工"}},inputPlaceholder:"權限選擇",showCancelButton:!0,inputValidator:a=>new Promise(c=>{c(a===""?"尚未選擇新的權限":"")})});if(!t)return;console.log(t),t.includes("知客")?l.value.ChurchName="知客":t.includes("寮房")?l.value.ChurchName="寮房":l.value.ChurchName="系統管理員",l.value.DeaconName=t,n.patchAuth(l.value,!0),v.fire({icon:"success",title:"已修改權限",showConfirmButton:!1,timer:1500}),h()}catch(t){console.error(t)}}return(o,t)=>(_(),r("main",E,[e("div",H,[x(U,null,{title:f(()=>[I(" 使用者權限管理 ")]),_:1}),e("div",L,[O,k(e("select",{id:"search",class:"form-select form-select-lg",style:{"max-width":"400px"},"aria-label":".form-select-lg example","onUpdate:modelValue":t[0]||(t[0]=a=>u.value=a),onChange:h},J,544),[[A,u.value]])]),e("p",Q,d(u.value),1),x(j,null,{thead:f(()=>[R]),tbody:f(()=>[m.value.length?(_(!0),r(M,{key:1},S(m.value,(a,c)=>(_(),r("tr",{key:a.Id,class:B({"table-active":l.value.Id===a.Id}),onClick:me=>l.value=a},[e("td",null,d(c+1),1),ee,te,se,oe,ae,le,e("td",null,d(y(F)(a.CreatedAt))+" / "+d(y(K)(a.CreatedAt)),1),e("td",{class:"cursor-point",onClick:g(()=>b(a),["prevent"]),onKeydown:g(()=>b(a),["prevent"])},ce,40,ne)],10,Z))),128)):(_(),r("tr",W,Y))]),_:1}),e("div",re,[e("button",{type:"button",class:"btn btn-outline-primary py-3 flex-grow-1",style:{"max-width":"184px"},disabled:!l.value.Id,onClick:t[1]||(t[1]=g(a=>w(l.value),["prevent"]))}," 移除權限 ",8,de),_e])])]))}});const ye=P(ue,[["__scopeId","data-v-55a56e67"]]);export{ye as default};
