import{f as z,g as n,B as S,c as a,a as e,b as u,w as f,s as h,l as d,F as b,k as x,M as k,v as g,u as N,j as i,r as V,o as s,t as v,C as B}from"./index-3e683233.js";import{_ as U}from"./BackTitle.vue_vue_type_script_setup_true_lang-3c0c9404.js";import{P as A}from"./ProcessSteps-578ecbf5.js";import{_ as D}from"./BeforeSearch.vue_vue_type_script_setup_true_lang-5fe11a3a.js";import{_ as Q}from"./FormList.vue_vue_type_script_setup_true_lang-6b824f3c.js";import{A as R}from"./AdminStore-5e05b7c4.js";import{Q as j}from"./qrcode.vue.esm-6670a9d3.js";import"./OpenSideBar.vue_vue_type_script_setup_true_lang-7e642112.js";import"./GuestStore-2246292a.js";import"./UserStore-0e330b01.js";import"./SweetAlert-183ed47c.js";import"./Timer-8447a705.js";const F={class:"row"},I={class:"col h-100 gx-xl-5 pt-xl-4 pb-xl-5 py-3 mb-xl-2"},M={class:"box-style p-xl-5 p-3"},P=e("h2",{class:"h3 fw-semibold mb-4"},"請選擇堂口名稱及執事",-1),E={class:"row"},J={class:"col-12 col-xl mb-xl-3 mb-4"},L=e("label",{for:"hall",class:"form-label fw-semibold fs-5"},"堂口名稱",-1),O=["value"],T={class:"col-12 col-xl"},G=e("label",{for:"deacon",class:"form-label fw-semibold fs-5"},"執事名稱",-1),H=["value"],K={class:"d-flex justify-content-end gap-3 mt-5"},W={key:3,class:"box-style d-flex flex-column align-items-center py-xl-5 py-3"},X=e("h2",{class:"h3 fw-semibold"},"使用者註冊連結",-1),Y={class:"text-danger mt-3"},Z=e("h3",{class:"h4 fw-semibold mb-3"},"注意事項",-1),ee=e("p",{class:"fs-5 mb-5"},[i("此為一次性註冊連結 "),e("br"),i("二十分鐘後失效")],-1),_e=z({__name:"AddAuthorization",setup(se){const c=R(),$=B(),y=n(["個資查詢","基本資料","權限設定","註冊連結"]),p=n({知客:["總知客","副總知客","知客志工"],寮房:["寮房師","副寮房師","寮房志工"],系統管理員:["系統管理員"]}),l=n("知客"),_=n(p.value[l.value][0]),q=n(`${window.location.origin}${window.location.pathname}#/register?qr=`);function C(){const o={UserId:JSON.parse(sessionStorage.tempUser).Id,DeaconName:_.value,ChurchName:l.value};c.createdQR(o)}return S(()=>c.qrcode,()=>{$.push("/back/permissions/authorized/new?step=4")}),(o,m)=>{const w=V("router-link");return s(),a("main",F,[e("div",I,[u(U,null,{title:f(()=>[i(v(y.value[Number(o.$route.query.step)-1]),1)]),_:1}),u(A,{steps:y.value},null,8,["steps"]),e("div",null,[Number(o.$route.query.step)===1?(s(),h(D,{key:0})):d("",!0),Number(o.$route.query.step)===2?(s(),h(Q,{key:1,pre:"/back/permissions/authorized/new?step=1",next:"/back/permissions/authorized/new?step=3"})):Number(o.$route.query.step)===3?(s(),a(b,{key:2},[e("section",M,[P,e("div",E,[e("div",J,[L,x(e("select",{name:"堂口名稱",id:"hall",class:"form-select form-select-lg","aria-label":".form-select-lg example","onUpdate:modelValue":m[0]||(m[0]=t=>l.value=t)},[(s(!0),a(b,null,g(p.value,(t,r)=>(s(),a("option",{value:r,key:r},v(r),9,O))),128))],512),[[k,l.value]])]),e("div",T,[G,x(e("select",{name:"執事名稱",id:"deacon",class:"form-select form-select-lg","aria-label":".form-select-lg example","onUpdate:modelValue":m[1]||(m[1]=t=>_.value=t)},[(s(!0),a(b,null,g(p.value[l.value],(t,r)=>(s(),a("option",{value:t,key:t+r},v(t),9,H))),128))],512),[[k,_.value]])])])]),e("div",K,[u(w,{to:"/back/permissions/authorized/new?step=1",class:"btn btn-outline-primary py-3 flex-grow-1",style:{"max-width":"184px"}},{default:f(()=>[i(" 上一步 ")]),_:1}),e("button",{type:"button",class:"btn btn-primary text-white py-3 flex-grow-1",style:{"max-width":"184px"},onClick:C}," 產出註冊連結 ")])],64)):d("",!0),Number(o.$route.query.step)===4?(s(),a("div",W,[X,N(c).qrcode?(s(),h(j,{key:0,class:"d-block mx-auto",value:q.value+N(c).qrcode,size:200},null,8,["value"])):d("",!0),e("section",Y,[Z,ee,u(w,{to:"/back/permissions/authorized",class:"btn btn-xl w-100 btn-primary text-white"},{default:f(()=>[i("回權限核發頁")]),_:1})])])):d("",!0)])])])}}});export{_e as default};
