import{f as C,g as m,n as $,o as u,c as p,a as e,b as y,w as v,j as k,k as D,E as I,t as s,F as B,q as M,i as b,s as S,y as w,p as V,e as P,_ as j}from"./index-411d2773.js";import{_ as A}from"./BackTitle.vue_vue_type_script_setup_true_lang-cccead52.js";import{_ as U}from"./StickyTable.vue_vue_type_script_setup_true_lang-baeb24eb.js";import{g as E,a as F,S as i}from"./Timer-be35b41e.js";import"./OpenSideBar.vue_vue_type_script_setup_true_lang-a3265a06.js";const n=d=>(V("data-v-95eb4e75"),d=d(),P(),d),K={class:"row"},q={class:"col h-100 gx-lg-5 pt-lg-4 pb-lg-5 py-3 mb-lg-2"},z=n(()=>e("label",{class:"form-label fw-semibold fs-5",for:"search"},"查詢權限名單",-1)),H=n(()=>e("option",{disabled:""},"選擇堂口名稱",-1)),L=n(()=>e("option",{value:"知客",selected:""},"知客",-1)),O=n(()=>e("option",{value:"寮房"},"寮房",-1)),T=[H,L,O],G={class:"fs-3"},J=n(()=>e("tr",null,[e("th",null,"編號"),e("th",null,"性別"),e("th",null,"法名"),e("th",null,"俗名"),e("th",null,"電話"),e("th",null,"執事名稱"),e("th",null,"核發權限者"),e("th",null,"核發權限日期"),e("th",null,"修改")],-1)),Q={key:0},R=n(()=>e("td",{colspan:"9"},"當前堂口無任何人員",-1)),W=[R],X=["onClick"],Y=["onClick","onKeydown"],Z=n(()=>e("p",{class:"mb-0 d-flex align-items-center justify-content-center gap-2"},[e("span",{class:"material-symbols-outlined"}," edit "),e("span",{class:"d-none d-lg-block"},"修改")],-1)),ee=[Z],te={class:"d-flex justify-content-end gap-3 mt-5"},le=n(()=>e("button",{type:"button",class:"btn btn-primary py-3 flex-grow-1",style:{"max-width":"184px"}}," 查看個資 ",-1)),ae=C({__name:"AuthorityManagement",setup(d){const r=m("知客"),o=m([{id:1,sex:"男",legalName:"",originalName:"王一信",tel:"0910111222",hall:"知客",deacon:"總知客",editorId:3,editorDate:1682575205902},{id:2,sex:"男",legalName:"普戊",originalName:"王大信",tel:"0910111222",hall:"寮房",deacon:"寮房師",editorId:3,editorDate:1682575205902},{id:3,sex:"女",legalName:"",originalName:"李大花",tel:"0910111222",hall:"知客",deacon:"知客志工",editorId:3,editorDate:1682575205902}]),_=m([]);function c(){_.value=o.value.filter(l=>l.hall===r.value)}$(()=>c());const f=m({id:0,sex:"",legalName:"",originalName:"",tel:"",hall:"",deacon:"",editorId:0,editorDate:1682575205902});async function N(l){const a=o.value.findIndex(t=>t.id===l.id);if(a===-1){i.fire({icon:"error",title:"還未選擇四眾法眷",showConfirmButton:!1,timer:1500});return}try{(await i.fire({html:`<p class="mb-0 fs-3">是否移除<b class="px-2 text-danger fw-semibold">${l.legalName?`${l.legalName}-`:""}${l.originalName?`${l.originalName}-`:""}${l.sex}</b>的權限</p>`,showCancelButton:!0})).isConfirmed&&(i.fire({icon:"success",title:"已移除權限",showConfirmButton:!1,timer:1500}),o.value.splice(a,1),c())}catch(t){console.error(t)}}async function x(l){const a=o.value.findIndex(t=>t.id===l.id);if(a===-1){i.fire({icon:"error",title:"還未選擇四眾法眷",showConfirmButton:!1,timer:1500});return}try{const{value:t}=await i.fire({html:`<p class="mb-0 fs-3">是否修改<b class="px-2 text-danger fw-semibold">${l.legalName?`${l.legalName}-`:""}${l.originalName?`${l.originalName}-`:""}${l.sex}</b>的權限</p>`,input:"select",inputOptions:{知客:{總知客:"總知客",副總知客:"副總知客",知客志工:"知客志工"},寮房:{寮房師:"寮房師",副寮房師:"副寮房師",寮房志工:"寮房志工"}},inputPlaceholder:"權限選擇",showCancelButton:!0,inputValidator:h=>new Promise(g=>{g(h===""?"尚未選擇新的權限":"")})});if(!t||o.value[a].deacon===t)return;t.includes("知客")?(o.value[a].hall="知客",o.value[a].deacon=t):(o.value[a].hall="寮房",o.value[a].deacon=t),o.value[a].editorDate=Date.now(),i.fire({icon:"success",title:"已修改權限",showConfirmButton:!1,timer:1500}),c()}catch(t){console.error(t)}}return(l,a)=>(u(),p("main",K,[e("div",q,[y(A,null,{title:v(()=>[k(" 使用者權限管理 ")]),_:1}),z,D(e("select",{id:"search",class:"form-select form-select-lg fs-5 mb-4",style:{"max-width":"400px"},"aria-label":".form-select-lg example","onUpdate:modelValue":a[0]||(a[0]=t=>r.value=t),onChange:c},T,544),[[I,r.value]]),e("p",G,s(r.value),1),y(U,null,{thead:v(()=>[J]),tbody:v(()=>[_.value.length?(u(!0),p(B,{key:1},M(_.value,(t,h)=>(u(),p("tr",{key:t.id,class:S({"table-active":f.value.id===t.id}),onClick:g=>f.value=t},[e("td",null,s(h+1),1),e("td",null,s(t.sex),1),e("td",null,s(t.legalName),1),e("td",null,s(t.originalName),1),e("td",null,s(t.tel),1),e("td",null,s(t.deacon),1),e("td",null,s(t.editorId),1),e("td",null,s(w(E)(t.editorDate))+" / "+s(w(F)(t.editorDate)),1),e("td",{class:"cursor-point",onClick:b(()=>x(t),["prevent"]),onKeydown:b(()=>x(t),["prevent"])},ee,40,Y)],10,X))),128)):(u(),p("tr",Q,W))]),_:1}),e("div",te,[e("button",{type:"button",class:"btn btn-outline-primary py-3 flex-grow-1",style:{"max-width":"184px"},onClick:a[1]||(a[1]=b(t=>N(f.value),["prevent"]))}," 移除權限 "),le])])]))}});const re=j(ae,[["__scopeId","data-v-95eb4e75"]]);export{re as default};
