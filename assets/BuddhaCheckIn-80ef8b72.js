import{f as U,g as d,C as O,r as z,o as s,c as o,a as e,F as g,v as N,x as S,k as L,D as E,b as f,w as x,j as q,B as T,h as F,S as G,R as Q,t as n,u as h,l as u,s as _,z as J,U as W}from"./index-3e683233.js";import{_ as A}from"./BackTitle.vue_vue_type_script_setup_true_lang-3c0c9404.js";import{P as K}from"./ProcessSteps-578ecbf5.js";import{_ as X}from"./StickyTable.vue_vue_type_script_setup_true_lang-26e1ec92.js";import{_ as Y,H as Z,O as ee}from"./OtherInfo-c97f522c.js";import{_ as te}from"./FormList.vue_vue_type_script_setup_true_lang-6b824f3c.js";import{_ as se}from"./MealSurvey.vue_vue_type_script_setup_true_lang-feb669ab.js";import{a as H}from"./SweetAlert-183ed47c.js";import{B as V}from"./BuddhaStore-413c4e65.js";import{Q as ae}from"./qrcode.vue.esm-6670a9d3.js";import{G as ne}from"./GuestStore-2246292a.js";import{g as w,a as D}from"./Timer-8447a705.js";import{t as M}from"./TagStyle-77d4d103.js";import"./OpenSideBar.vue_vue_type_script_setup_true_lang-7e642112.js";import"./UserStore-0e330b01.js";const oe=e("div",{class:"row justify-content-center gap-4 mx-0"},[e("section",{class:"col-10 mb-3"},[e("p",{class:"h3 mb-0"},"南無阿彌陀佛")])],-1),le={class:"row justify-content-center gap-4 mx-0"},ce={class:"col-5 box-style gx-xl-0 p-xl-5 p-3 h-max fs-5 list-inline w-75 mx-auto"},re=["value","id"],ue=["for","innerHTML"],de={class:"d-flex justify-content-end gap-3 mt-3 mt-xl-4"},ie=U({__name:"BuddhaCheckEnd",setup(P){const m=d([]),r=d(["1.佛七報到僅限一期佛七，欲連續參加第二期佛七者，<br>請於佛七圓滿日再進行下一期佛七報到。","2.於離單日，應主動清理寮房環境，<br>並交由執事法師檢查後，再行離單。","3.每月七號為志工日，<br>請留下來發心參與志工日後，再行離單。","4.若於掛單共住期間，嚴重違反本寺規約，<br>如：打（吵）架、傳播是非等，<br>常住得依規定予以遷單，掛單者不得有異議，<br>並於告知遷單當日自行離單。 "]),l=V(),y=O();function v(){m.value.length>=r.value.length?l.checkInBuddha(sessionStorage.tempId,JSON.parse(sessionStorage.tempUser),y):H.fire({icon:"error",title:"請詳閱報到注意事項"})}return(C,p)=>{const b=z("router-link");return s(),o(g,null,[oe,e("div",le,[e("ol",ce,[(s(!0),o(g,null,N(r.value,(c,k)=>(s(),o("li",{key:k,class:S(["form-check",{"mb-4":k!==r.value.length-1}])},[L(e("input",{class:"form-check-input",type:"checkbox",value:c,id:c+k,"onUpdate:modelValue":p[0]||(p[0]=I=>m.value=I)},null,8,re),[[E,m.value]]),e("label",{class:"form-check-label",for:c+k,innerHTML:c},null,8,ue)],2))),128))])]),e("div",de,[f(b,{to:"/back/buddha/checkIn?step=6",class:"btn btn-outline-primary py-3 flex-grow-1",style:{"max-width":"184px"}},{default:x(()=>[q(" 上一步 ")]),_:1}),e("button",{type:"button",class:"btn btn-primary text-white py-3 flex-grow-1",style:{"max-width":"184px"},onClick:v}," 報到完成 ")])],64)}}}),he={class:"row mx-0"},pe={class:"col h-100 gx-xl-5 pt-xl-4 pb-xl-5 py-3 mb-xl-2"},be={class:"d-flex align-items-center gap-2 gap-xl-4 mb-5"},me={class:"form-floating",style:{"max-width":"500px"}},ke=e("label",{for:"floatingInput"},"請輸入報名時填寫之聯絡電話",-1),_e=["disabled"],fe={class:"h3 fw-semibold"},ye=e("tr",null,[e("th",null,"報名序號"),e("th",null,"性別"),e("th",null,"法名"),e("th",null,"俗名"),e("th",null,"電話"),e("th",null,"預計報到日"),e("th",null,"預計離單日"),e("th",null,"報到當天用齋"),e("th",null,"狀態"),e("th",null,"報到知客"),e("th",null,"報到時間"),e("th",null,"備註")],-1),ve={key:0},Ie={colspan:"12"},xe=["onClick"],ge={key:0,class:"mb-0"},Ce={key:1,class:"mb-0"},we={key:2,class:"mb-0"},De={key:3,class:"mb-0"},Se={key:0},$e={class:"d-flex justify-content-end gap-3 mt-3 mt-xl-4"},Be=["disabled"],Te={class:"modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable"},Me={class:"modal-content"},Ue=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"staticBackdropLabel"},"四眾報到連結"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Oe={class:"modal-body"},Ke=U({__name:"BuddhaCheckIn",setup(P){const m=d(["報名資料查詢","個資蒐集同意","個人資料","用齋調查","健康狀況","學經歷、專長及來寺因緣","簽署同意遵守掛單規約"]),r=d([]),l=d({}),y=O(),v=J();function C(a){const{tempUser:i}=sessionStorage;a.startsWith("/back/buddha/checkIn")&&a.split("step=")[1]!=="1"&&(i||y.push("/back/buddha/checkIn?step=1"))}T(()=>v.fullPath,a=>C(a));const p=d(!1),b=V();F(()=>{b.getCheckInList(),C(v.fullPath),sessionStorage.tempUser||sessionStorage.setItem("tempUser","{}")}),T(()=>b.checkInOrder,()=>{r.value=b.checkInOrder}),G((a,i,t)=>{sessionStorage.removeItem("tempUser"),t()});const c=d("");function k(){r.value=b.checkInOrder.filter(a=>c.value===a.Mobile||c.value===a.Phone),p.value=!0}function I(){p.value=!1,r.value=b.checkInOrder,c.value="",l.value={}}const $=d(""),B=d(null),j=ne();function R(){H.mixin({customClass:{confirmButton:"btn btn-primary btn-lg",cancelButton:"d-none",denyButton:"btn btn-outline-primary btn-lg me-3"},buttonsStyling:!1}).fire({title:"填寫個資",showCancelButton:!0,confirmButtonText:"報到者填寫",denyButtonText:"知客代填",cancelButtonText:"取消",showDenyButton:!0}).then(i=>{if(i.isConfirmed){const t=new W(B.value);$.value=`${window.location.origin}${window.location.pathname}#/${l.value.UserId}?step=1`,t.show()}i.isDenied&&(j.getUser(l.value.UserId),sessionStorage.setItem("tempId",l.value.Id),y.push("/back/buddha/checkIn?step=2"))})}return(a,i)=>(s(),o("main",he,[e("div",pe,[f(A,null,{title:x(()=>[q(n(m.value[Number(a.$route.query.step)-1]),1)]),_:1}),f(K,{steps:m.value},null,8,["steps"]),a.$route.query.step==="1"?(s(),o(g,{key:0},[e("form",be,[e("div",me,[L(e("input",{type:"tel",class:"form-control",id:"floatingInput",placeholder:"09xxxxxxxx",name:"tel","onUpdate:modelValue":i[0]||(i[0]=t=>c.value=t)},null,512),[[Q,c.value]]),ke]),e("button",{type:"button",class:"btn btn-primary flex-shrink-0",disabled:!c.value,onClick:k}," 查詢 ",8,_e)]),e("h2",fe,n(h(w)(Date.now()))+"/"+n(h(D)(Date.now()))+"今日預計報到名單 ",1),f(X,null,{thead:x(()=>[ye]),tbody:x(()=>[r.value.length?(s(!0),o(g,{key:1},N(r.value,t=>(s(),o("tr",{key:t.Id,onClick:Ne=>l.value=t,class:S({"table-active":l.value.Id===t.Id})},[e("td",null,n(t.Id),1),e("td",null,n(t.IsMale?"男":"女"),1),e("td",null,n(t.DharmaName),1),e("td",null,n(t.Name),1),e("td",null,n(t.Mobile||t.Phone),1),e("td",null,n(h(w)(new Date(t.CheckInDate).valueOf()))+"/"+n(h(D)(new Date(t.CheckInDate).valueOf())),1),e("td",null,n(h(w)(new Date(t.CheckOutDate).valueOf()))+"/"+n(h(D)(new Date(t.CheckOutDate).valueOf())),1),e("td",null,[t.CheckInDateDinner&&t.CheckInDateLunch?(s(),o("p",ge," 用午齋、藥石 ")):t.CheckInDateLunch?(s(),o("p",Ce,"用午齋")):t.CheckInDateDinner?(s(),o("p",we,"用藥石")):(s(),o("p",De,"不用齋"))]),e("td",null,[e("p",{class:S(["py-2 px-3 mb-0 rounded-4",`bg-${h(M)[t.Status].bgColor} text-${h(M)[t.Status].textColor}`])},n(t.Status),3)]),e("td",null,n(t.CheckInUserDharmaName||t.CheckInUserName),1),e("td",null,[t.CheckInTime?(s(),o("span",Se,n(new Date(t.CheckInTime).getHours()<10?`0${new Date(t.CheckInTime).getHours()}`:new Date(t.CheckInTime).getHours())+"："+n(new Date(t.CheckInTime).getMinutes()<10?`0${new Date(t.CheckInTime).getMinutes()}`:new Date(t.CheckInTime).getMinutes()),1)):u("",!0)]),e("td",null,n(t.Remarks),1)],10,xe))),128)):(s(),o("tr",ve,[e("td",Ie,n(p.value?"查無此報名人員":"今日無報名人員"),1)]))]),_:1}),e("div",$e,[p.value?(s(),o("button",{key:0,type:"button",class:"btn btn-outline-primary py-3 flex-grow-1",style:{"max-width":"184px"},onClick:I}," 重新查詢 ")):u("",!0),e("button",{type:"button",class:"btn btn-primary py-3 flex-grow-1",style:{"max-width":"184px"},disabled:!l.value.Id||l.value.Status!=="已報名佛七"&&l.value.Status!=="寮房已確認",onClick:R}," 報到 ",8,Be)])],64)):u("",!0),a.$route.query.step==="2"?(s(),_(Y,{key:1,pre:"/back/buddha/checkIn?step=1",next:"/back/buddha/checkIn?step=3"})):u("",!0),a.$route.query.step==="3"?(s(),_(te,{key:2,pre:"/back/buddha/checkIn?step=2",next:"/back/buddha/checkIn?step=4"})):u("",!0),a.$route.query.step==="4"?(s(),_(se,{key:3,pre:"/back/buddha/checkIn?step=3",next:"/back/buddha/checkIn?step=5"})):u("",!0),a.$route.query.step==="5"?(s(),_(Z,{key:4,pre:"/back/buddha/checkIn?step=4",next:"/back/buddha/checkIn?step=6"})):u("",!0),a.$route.query.step==="6"?(s(),_(ee,{key:5,pre:"/back/buddha/checkIn?step=5",next:"/back/buddha/checkIn?step=7"})):u("",!0),a.$route.query.step==="7"?(s(),_(ie,{key:6})):u("",!0),e("div",{class:"modal fade",id:"staticBackdrop","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",ref_key:"modal",ref:B},[e("div",Te,[e("div",Me,[Ue,e("div",Oe,[f(ae,{class:"d-block mx-auto",value:$.value,size:150},null,8,["value"])]),e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-primary",onClick:I,"data-bs-dismiss":"modal"}," 回到報名單頁 ")])])])],512)])]))}});export{Ke as default};
