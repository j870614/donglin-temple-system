import{f as R,g as y,h as V,c as o,a as e,b as D,w as m,k as _,M as Y,F as p,v as g,t as d,R as h,l as w,o as s,j as F,u as i,x as M,p as T,e as $,_ as N}from"./index-0a7f7a6a.js";import{_ as O}from"./BackTitle.vue_vue_type_script_setup_true_lang-cc4a5e12.js";import{_ as C}from"./StickyTable.vue_vue_type_script_setup_true_lang-99a21f87.js";import{B as U}from"./BuddhaStore-48cfd59b.js";import{f as c}from"./Timer-8447a705.js";import"./OpenSideBar.vue_vue_type_script_setup_true_lang-b5b66885.js";import"./SweetAlert-183ed47c.js";import"./GuestStore-a6700c3e.js";import"./UserStore-f0f31fbe.js";const n=v=>(T("data-v-69262407"),v=v(),$(),v),j={class:"row"},K={class:"col h-100 gx-xl-5 pt-xl-4 pb-xl-5 py-3 mb-xl-2"},z={class:"fs-5 mb-4"},E=n(()=>e("label",{class:"form-label fw-semibold",for:"year"},"選擇年度",-1)),L=["value","selected"],q=n(()=>e("tr",null,[e("th",null,"期數"),e("th",null,"起七日"),e("th",null,"圓滿日"),e("th",null,"備註"),e("th",null,"修改")],-1)),A={key:0},G=n(()=>e("td",{colspan:"5"},"該年度無佛七資料",-1)),H=[G],J=["onClick"],P=["onClick","onKeydown"],Q=n(()=>e("p",{class:"mb-0 d-flex align-items-center justify-content-center gap-2"},[e("span",{class:"material-symbols-outlined"}," edit "),e("span",{class:"d-none d-xl-block"},"修改")],-1)),W=[Q],X={class:"modal fade",id:"exampleModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"addNewBuddha","aria-hidden":"true"},Z={class:"modal-dialog modal-dialog-centered modal-xl modal-dialog-scrollable"},ee={class:"modal-content"},te={class:"modal-header"},le={class:"modal-title",id:"addNewBuddha"},ae=n(()=>e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),oe={class:"modal-body"},se={key:0,class:"mb-4"},ne=n(()=>e("label",{for:"buddhaId",class:"form-label"},"佛七期數",-1)),de={class:"mb-4"},re=n(()=>e("label",{for:"buddhaDate",class:"form-label fw-semibold"},"佛七日期設定",-1)),ie={class:"d-flex gap-4 align-items-center"},ue=["max"],ce=n(()=>e("span",{class:"fs-3"},"~",-1)),me=["min"],_e=n(()=>e("label",{for:"notion",class:"form-label"},"備註",-1)),pe={class:"modal-footer"},ve={class:"d-flex justify-content-end gap-3 mt-5"},fe=n(()=>e("p",{class:"fs-3 fw-semibold"},"已圓滿之佛七",-1)),he=n(()=>e("tr",null,[e("th",null,"期數"),e("th",null,"起七日"),e("th",null,"圓滿日"),e("th",null,"備註")],-1)),be={key:0},ye=n(()=>e("td",{colspan:"5"},"該年度無佛七資料",-1)),De=[ye],ge={key:0},we=R({__name:"SetBuddha",setup(v){const f=y(new Date().getFullYear()),r=U(),k=y(null),a=y({Id:0,Remarks:"",StartSevenDate:"",CompleteDate:""});V(()=>{r.getTotal(new Date().getFullYear())});function I(){r.getTotal(f.value)}function x(){a.value={Id:0,Remarks:"",StartSevenDate:"",CompleteDate:""}}function b(u,l=""){u==="editor"?(a.value.Id=l.Id,a.value.Remarks=l.Remarks,a.value.StartSevenDate=c(new Date(l.StartSevenDate).valueOf(),!0,"-"),a.value.CompleteDate=c(new Date(l.CompleteDate).valueOf(),!0,"-")):x()}async function B(u){let l;u.Id?l=await r.editorBuddha(u):l=await r.addBuddha(u),l&&(k.value.click(),a.value.Id=0,r.getTotal(f.value)),x()}return(u,l)=>(s(),o("main",j,[e("div",K,[D(O,null,{title:m(()=>[F(" 佛七期數 ")]),_:1}),e("div",z,[E,_(e("select",{id:"year",class:"form-select form-select-lg",style:{"max-width":"400px"},"aria-label":".form-select-lg example","onUpdate:modelValue":l[0]||(l[0]=t=>f.value=t),onChange:I},[(s(!0),o(p,null,g(new Date().getFullYear()-2009,t=>(s(),o("option",{value:new Date().getFullYear()+1-t,key:t,selected:t+2010===new Date().getFullYear()-2009},d(new Date().getFullYear()+1-t),9,L))),128))],544),[[Y,f.value]])]),D(C,null,{thead:m(()=>[q]),tbody:m(()=>[i(r).totalBuddha.length?(s(!0),o(p,{key:1},g(i(r).totalBuddha,t=>(s(),o(p,{key:t.Id},[new Date(t.CompleteDate)>=new Date?(s(),o("tr",{key:0,class:M({"bg-primary-tint":a.value.Id===t.Id}),onClick:S=>a.value.Id=t.Id},[e("td",null,d(t.Id),1),e("td",null,d(i(c)(new Date(t.StartSevenDate).valueOf())),1),e("td",null,d(i(c)(new Date(t.CompleteDate).valueOf())),1),e("td",null,d(t.Remarks),1),e("td",{class:"cursor-point","data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:S=>b("editor",t),onKeydown:S=>b("editor",t)},W,40,P)],10,J)):w("",!0)],64))),128)):(s(),o("tr",A,H))]),_:1}),e("div",X,[e("div",Z,[e("div",ee,[e("div",te,[e("h5",le,d(a.value.Id?"修改佛七":"新增佛七"),1),ae]),e("div",oe,[a.value.Id?(s(),o("div",se,[ne,_(e("input",{type:"number",class:"form-control",id:"buddhaId",placeholder:"請輸入佛七期數","onUpdate:modelValue":l[1]||(l[1]=t=>a.value.Id=t),disabled:""},null,512),[[h,a.value.Id]])])):w("",!0),e("div",de,[re,e("div",ie,[_(e("input",{type:"date",class:"form-control rounded-4",id:"buddhaDate",max:a.value.CompleteDate,"onUpdate:modelValue":l[2]||(l[2]=t=>a.value.StartSevenDate=t)},null,8,ue),[[h,a.value.StartSevenDate]]),ce,_(e("input",{type:"date",class:"form-control rounded-4","aria-label":"end",min:a.value.StartSevenDate,"onUpdate:modelValue":l[3]||(l[3]=t=>a.value.CompleteDate=t)},null,8,me),[[h,a.value.CompleteDate]])])]),e("div",null,[_e,_(e("textarea",{class:"form-control",id:"notion",rows:"5","onUpdate:modelValue":l[4]||(l[4]=t=>a.value.Remarks=t)},null,512),[[h,a.value.Remarks]])])]),e("div",pe,[e("button",{type:"button",class:"btn btn-outline-primary me-5","data-bs-dismiss":"modal",ref_key:"modalClose",ref:k}," 取消 ",512),e("button",{type:"button",class:"btn btn-primary",onClick:l[5]||(l[5]=t=>B(a.value))},d(a.value.Id?"修改佛七":"新增佛七"),1)])])])]),e("div",ve,[e("button",{type:"button",class:"btn btn-primary py-3 flex-grow-1",style:{"max-width":"184px"},"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:l[6]||(l[6]=t=>b("new"))}," 新增佛七 ")]),fe,D(C,null,{thead:m(()=>[he]),tbody:m(()=>[i(r).totalBuddha.length?(s(!0),o(p,{key:1},g(i(r).totalBuddha,t=>(s(),o(p,{key:t.Id},[new Date(t.CompleteDate)<new Date?(s(),o("tr",ge,[e("td",null,d(t.Id),1),e("td",null,d(i(c)(new Date(t.StartSevenDate).valueOf())),1),e("td",null,d(i(c)(new Date(t.CompleteDate).valueOf())),1),e("td",null,d(t.Remarks),1)])):w("",!0)],64))),128)):(s(),o("tr",be,De))]),_:1})])]))}});const Fe=N(we,[["__scopeId","data-v-69262407"]]);export{Fe as default};
