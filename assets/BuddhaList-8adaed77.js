import{f as F,g as p,n as L,o,c as r,a as t,b as $,w as D,j as w,k as I,E as B,y as s,C as U,F as _,q as h,i as M,t as l,s as x,l as Y,p as j,e as E,_ as q}from"./index-775e4114.js";import{_ as z}from"./StickyTable.vue_vue_type_script_setup_true_lang-501ab389.js";import{_ as R}from"./BackTitle.vue_vue_type_script_setup_true_lang-626ba7bf.js";import{g as C,a as S,S as N}from"./Timer-1491371d.js";import"./OpenSideBar.vue_vue_type_script_setup_true_lang-c909ed21.js";function k(c,n,i,m){m.splice(0,m.length);const y=i.filter(g=>new Date(g.registrationDate).getFullYear()===c&&new Date(g.registrationDate).getMonth()+1===n);m.push(...y)}const v=c=>(j("data-v-54fc8ef8"),c=c(),E(),c),T={class:"row"},G={class:"col h-100 gx-lg-5 pt-lg-4 pb-lg-5 py-3 mb-lg-2"},H={class:"d-flex flex-column flex-lg-row gap-lg-4 gap-2 mb-3 mb-lg-4"},J=v(()=>t("label",{class:"form-label fw-semibold fs-5",for:"year"},"年份",-1)),K=["value","selected"],O=v(()=>t("label",{class:"form-label fw-semibold fs-5",for:"month"},"月份",-1)),P=["value","selected"],Q={key:0,class:"material-symbols-outlined fs-6"},W={key:0},X=v(()=>t("td",{colspan:"12"},"當前月份無報名資訊",-1)),Z=[X],A=["onClick"],ee={key:1,class:"mb-0"},te=v(()=>t("p",{class:"mb-0 d-flex align-items-center justify-content-center gap-2"},[t("span",{class:"material-symbols-outlined"}," edit "),t("span",{class:"d-none d-lg-block"},"修改")],-1)),le=[te],ae={class:"d-flex justify-content-end gap-3 mt-5"},se=["disabled"],oe=v(()=>t("button",{type:"button",class:"btn btn-primary py-3 flex-grow-1",style:{"max-width":"184px"}}," 報名佛七 ",-1)),re=F({__name:"BuddhaList",setup(c){const n=new Date().getFullYear(),i=new Date().getMonth()+1,m=p({已報到:{textColor:"success",bgColor:"success-10"},寮房師已確認:{textColor:"white",bgColor:"primary"},新登錄報名:{textColor:"primary",bgColor:"primary-tint"},已取消:{textColor:"neutral-80",bgColor:"neutral-40"}}),y=p([{title:"報名序號",needSort:!0},{title:"性別",needSort:!1},{title:"法名",needSort:!1},{title:"俗名",needSort:!1},{title:"電話",needSort:!1},{title:"預計報到日",needSort:!0},{title:"預計離單日",needSort:!0},{title:"報到當天用齋",needSort:!1},{title:"狀態",needSort:!0},{title:"登錄 / 修改者",needSort:!1},{title:"登錄 / 修改日期",needSort:!0},{title:"修改",needSort:!1}]),g=p([{id:1,sex:"男",legalName:"",originalName:"王一信",tel:"0910111222",registrationDate:16513344e5,leaveDate:165168e7,meal:"午齋",state:"已報到",editorId:3,editorDate:1682575205902},{id:2,sex:"男",legalName:"普己",originalName:"",tel:"0910111222",registrationDate:1682579440377,leaveDate:16830432e5,meal:"午齋",state:"已報到",editorId:3,editorDate:16813152e5},{id:3,sex:"男",legalName:"普己",originalName:"王三",tel:"0910111222",registrationDate:16960896e5,leaveDate:1696608e6,meal:"午齋",state:"已報到",editorId:3,editorDate:1682575205902},{id:4,sex:"男",legalName:"普己",originalName:"王四",tel:"0910111222",registrationDate:16960896e5,leaveDate:1696608e6,meal:"午齋",state:"已報到",editorId:3,editorDate:1696608e6}]),d=p([]);L(()=>{k(n,i,g.value,d.value)});const f=p({id:0,sex:"",legalName:"",originalName:"",tel:"",registrationDate:1682575205902,leaveDate:1682575205902,meal:"",state:"",editorId:0,editorDate:1682575205902});async function V(u){const a=d.value.findIndex(e=>e.id===u.id);if(a===-1){N.fire({icon:"error",title:"還未選擇四眾法眷",showConfirmButton:!1,timer:1500});return}try{(await N.fire({html:`<p class="mb-0 fs-3">是否取消<b class="px-2 text-danger fw-semibold">${u.legalName?`${u.legalName}-`:""}${u.originalName?`${u.originalName}-`:""}${u.sex}</b>的預約</p>`,showCancelButton:!0})).isConfirmed&&(N.fire({icon:"success",title:"已取消佛七預約",showConfirmButton:!1,timer:1500}),d.value[a].state="已取消",d.value[a].editorDate=Date.now())}catch(e){console.error(e)}}return(u,a)=>(o(),r("main",T,[t("div",G,[$(R,null,{title:D(()=>[w(" 佛七預約報名表單 ")]),_:1}),t("div",H,[t("div",null,[J,I(t("select",{id:"year",class:"form-select form-select-lg fs-5","aria-label":".form-select-lg example","onUpdate:modelValue":a[0]||(a[0]=e=>U(n)?n.value=e:null),onChange:a[1]||(a[1]=e=>s(k)(s(n),i,g.value,d.value))},[(o(!0),r(_,null,h(new Date().getFullYear()-2009,e=>(o(),r("option",{value:s(n)+1-e,key:e,selected:e+2010===s(n)-2009},l(s(n)+1-e),9,K))),128))],544),[[B,s(n)]])]),t("div",null,[O,I(t("select",{id:"month",class:"form-select form-select-lg fs-5","aria-label":".form-select-lg example","onUpdate:modelValue":a[2]||(a[2]=e=>i=e),onChange:a[3]||(a[3]=e=>s(k)(s(n),i,g.value,d.value))},[(o(),r(_,null,h(12,e=>t("option",{value:e,key:e,selected:e===i},l(e),9,P)),64))],544),[[B,i]])])]),$(z,null,{thead:D(()=>[t("tr",null,[(o(!0),r(_,null,h(y.value,(e,b)=>(o(),r("th",{key:e.title+b,class:x({"cursor-point":e.needSort})},[w(l(e.title)+" ",1),e.needSort?(o(),r("span",Q," arrow_drop_up ")):Y("",!0)],2))),128))])]),tbody:D(()=>[d.value.length?(o(!0),r(_,{key:1},h(d.value,(e,b)=>(o(),r("tr",{key:e.id+b,class:x({"table-active":f.value.id===e.id}),onClick:M(ne=>f.value=e,["prevent"])},[t("td",null,l(b+1),1),t("td",null,l(e.sex),1),t("td",null,l(e.legalName),1),t("td",null,l(e.originalName),1),t("td",null,l(e.tel),1),t("td",null,l(s(C)(e.registrationDate))+" / "+l(s(S)(e.registrationDate)),1),t("td",null,l(s(C)(e.leaveDate))+" / "+l(s(S)(e.leaveDate)),1),t("td",null,[e.state==="已取消"?(o(),r(_,{key:0},[w("已取消")],64)):(o(),r("p",ee,l(e.meal?`用${e.meal}`:"不用齋"),1))]),t("td",null,[t("p",{class:x(["py-2 px-3 mb-0 rounded-4",`bg-${m.value[e.state].bgColor} text-${m.value[e.state].textColor}`])},l(e.state),3)]),t("td",null,l(e.editorId),1),t("td",null,l(s(C)(e.editorDate))+" / "+l(s(S)(e.editorDate)),1),t("td",{class:x({"cursor-point":e.state!=="已取消","text-neutral-60":e.state==="已取消"})},le,2)],10,A))),128)):(o(),r("tr",W,Z))]),_:1}),t("div",ae,[t("button",{type:"button",class:"btn btn-outline-primary py-3 flex-grow-1",style:{"max-width":"184px"},onClick:a[4]||(a[4]=M(e=>V(f.value),["prevent"])),disabled:f.value.state==="已取消"}," 取消預約 ",8,se),oe])])]))}});const ge=q(re,[["__scopeId","data-v-54fc8ef8"]]);export{ge as default};
